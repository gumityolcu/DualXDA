Bootstrap: docker
From: pytorch/pytorch:2.6.0-cuda12.4-cudnn9-devel

%files

  ../scikit-learn-dual /sklearn
  ../captum /captum

%post

  export "PATH=/opt/conda/bin:$PATH"
  pip install --upgrade pip
  pip install numpy \
    matplotlib \
    xmltodict \
    pyyaml \
    tqdm \
    scikit-image \
    scipy \
    seaborn \
    termcolor
  pip install zennit
  pip install tensorboard
  pip install /sklearn
  pip install /captum
  pip install kronfluence
  pip install datasets
  pip install transformers

%runscript

  cd /mnt/src
  pwd
  ls
  pip install --no-cache-dir --no-binary :all: --no-build-isolation fast_jl
  python -c "import fast_jl; print('fast_jl imported successfully')"
  pip install traker[fast]
  python -c "from trak.projectors import CudaProjector; print('traker imported successfully')"
  python explain.py "$@"
